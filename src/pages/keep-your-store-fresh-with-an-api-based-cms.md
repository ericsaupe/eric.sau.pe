---
templateKey: blog-post
title: Keep your store fresh with an API-based CMS
date: '2017-07-14T10:40:00-07:00'
tags:
  - api based cms
  - contentful
  - ecommerce
  - london
  - prismic.io
  - rails
  - solidus
  - solidusconf
  - solidusconf2017
---
<h1>SolidusConf 2017</h1>
I am very proud to say that I was a chosen speaker at this year's <a href="http://conf2017.solidus.io/">SolidusConf</a>.  <a href="https://solidus.io/">Solidus</a> is an open-source eCommerce platform written in Rails. We use it at DeseretBook.com and contribute actively to the project. Below is a transcript of the talk as well as my slides. They say the video will be released soon and when it does I'll post it here. I think the transcript will read better than I presented it so start there. Before we get to all of that I would like to thank my wife for all of her love and support, <a href="https://twitter.com/n00b2pr0">Greg Price</a> for the topic idea, and <a href="https://twitter.com/AshtonHerrmann">Ashton Herrmann</a> for editing and proof reading. They really made this thing come together and without them it wouldn't have been nearly this good.

<a href="https://docs.google.com/document/d/1_BMUJn9bv0nuZFQuagTFUJftS2-l3N0ACTMWgU3JRwM/edit?usp=sharing">Link to Talk</a>

<a href="https://docs.google.com/presentation/d/1rVPy4w8ocTi7NNKxOmp4hv3I63a8dykh_v5f0NkyQFI/edit?usp=sharing">Link to Slides</a>
<h1>Keep your store fresh with an API-based CMS</h1>
<h1><span style="font-weight: 400;">Introduction</span></h1>
<span style="font-weight: 400;">Hello. I’m incredibly happy to be here and excited to tell you about API-based CMSes for your stores. We’ve seen incredible improvements to our sales, advertising potential, and quality of life from these changes.</span>

<span style="font-weight: 400;">My name is Eric Saupe. I work for Deseret Book, a book publisher focused on selling Christian and Latter-day Saint products and founded in 1866. We have over 20,000 salable variants including digital products like ebooks and audiobooks. Those products are sold in our 45 retails stores and authorized reseller locations as well as online. We have an e-reader app called Deseret Bookshelf for iOS and Android, and we just launched a subscription service for unlimited access to our audiobooks and over a thousand ebooks. All purchases for Deseret Bookshelf happen through our Solidus-based DeseretBook.com, and our online orders for physical products are fulfilled through our own warehouse, which runs on Oracle and Logpro.  Our physical products include books, art and home, jewelry, and clothing. Hopefully that gives you a small glimpse into the breadth of products we sell and services we have to communicate with through our Solidus store.</span>
<h1><span style="font-weight: 400;">Scipio</span></h1>
<span style="font-weight: 400;">Let’s talk about our road to API-based CMSes. In the beginning DeseretBook.com was a totally custom Rails app without any sort of open-source e-commerce gem installed. Our marketing team has a really long tail of products to choose from, but unfortunately, the home page was really the only place we had marketing options available. Every time they had new product to advertise, they would send us, the developers, the requested changes: new images, new copy, etc., and we would plan that into our sprint and spend developer time to update the homepage and release for QA before finally deploying to production. </span>

<span style="font-weight: 400;">The other trick was scheduling deploys. Since they would often be advertising sales on the homepage, we would need to make sure a developer was ready to deploy at midnight to ensure the sale turned on and off properly.</span>

<span style="font-weight: 400;">I’m sure a lot of you have experiences that are probably pretty similar to that. Back then, whenever there were storewide sales, we would create a Category of products</span><span style="font-weight: 400;">—</span><span style="font-weight: 400;">a category is what we would now refer to as a Taxon</span><span style="font-weight: 400;">—</span><span style="font-weight: 400;">and place all of their Sale Products in there so they could link to that in their emails. I actually like that approach, but you can see how time consuming all of this would be. </span>

<span style="font-weight: 400;">On our homepage there was a Top Ten list that was somewhat automated albeit misleading to the consumer. It took all products sold in the last two weeks and figured out which ones gave us the most revenue. So it really wasn’t the most “popular” since we could have sold a single $2,000 painting and 600 $3 bookmarks and the single painting would be more “popular” to the end user.</span>

<span style="font-weight: 400;">It wasn’t all static though; we did use Adobe Target to selectively inject some neat things to users but only in a couple of places. At the top of the page under the navigation we could add messages to the user about sales or site updates. That was more or less all we had as far as tools go for the marketing team. Everything else was done by hand by either the marketing team with their Category pages or with the help of the developers manually updating the homepage.</span>
<h1><span style="font-weight: 400;">Nibley</span></h1>
<span style="font-weight: 400;">As DeseretBook.com grew it became apparent that our custom Rails app was just way too hard to maintain with the number of requests for features and bugs that were coming in. That’s when we started looking at open-source solutions and found Spree. It sounded like a great deal: we take advantage of open source software to help us maintain the e-commerce platform of the site while we figure out how to make it communicate with our warehouse and e-reader API. Simple enough. As part of this upgrade, we were going to give more tools to the marketers to control more of the site. We wanted them to be successful in their jobs, selling all of the different products we offer.</span>

<span style="font-weight: 400;">With that we let Adobe Target control all sections of the homepage. Images, text, and links were all given to Adobe Target to allow marketers to update whatever they like. This was pretty good in theory, but it had a lot of negatives in practice. For one, if Adobe Target was down, the homepage was empty. Also, many ad-blocking plugins blocked Adobe Target data entirely because it was requested from the client rather than the server. Our client base is not really likely to use ad-blockers, but as developers and for our more tech-savvy users, the homepage was basically blank. There was no default content served from the site itself; it all relied on Adobe Target.</span>

<span style="font-weight: 400;">This gave us a few ideas to improve and iterate on, though. It allowed for A/B testing, which led us to find that a curated Top Ten list outperformed the existing automated one. The marketing team also loved having more control over when homepage updates were released rather than relying on our busy schedules to squeeze in development and deploy times. But the flaws of Adobe Target were too much, and it was clear we needed to phase it out at the end of our contract.</span>
<h1><span style="font-weight: 400;">What Then?</span></h1>
<span style="font-weight: 400;">With Adobe Target on its way out the door we had a chance to reflect on what it was the marketing team really needed. Obviously, they wanted to update the homepage regularly and add content to other parts of the site like during checkout and just under the navigation, and they wanted scheduled releases. </span>

<span style="font-weight: 400;">So what were our options at the time? We could build custom tools for them right on top of Spree, but then we would need to maintain the new database tables, bug fixes, and still have deploys for those changes. As developers we wanted something with minimal maintenance that the marketers couldn’t mess up. That may sound harsh, but with Adobe Target they were given the power to drop in entire blocks of Javascript, and if there were errors in that Javascript, the pages would break. That’s when we found headless CMSes like Contentful and Prismic.io.</span>
<h1><span style="font-weight: 400;">Headless CMS</span></h1>
<span style="font-weight: 400;">Let me just quickly define what a headless CMS is so we can all be on the same page. A headless CMS is a content management system (CMS) that isn’t directly tied to your application. You can think of it like the Wordpress admin interface except it isn’t directly attached to your site.</span>

<span style="font-weight: 400;">A headless CMS gave us the low maintenance backend that we wanted. It maintains the database and the service for you. It provides the GUI for users to update data, and it will integrate with all of your applications because the data is returned as a JSON object. Many of them also have gems to get up and running quickly. Their GUIs are great for non-technical people, giving them WYSIWYG-type editing that they can save and collaborate on before publishing.</span>

<span style="font-weight: 400;">Marketers are in charge of publishing, leaving the developers to focus on developing new features and fixing bugs. We didn’t want to store marketing data in our database because that would add unnecessary complexity and maintenance onto our small team. Outsourcing our marketing data management and publishing to an API-based CMS allowed us to focus on growing the business and let the marketers move more quickly without having to wait for developers to start selling product.</span>
<h1><span style="font-weight: 400;">Prismic.io vs Contentful</span></h1>
<span style="font-weight: 400;">There are a number of headless CMS options out there, but we narrowed our options down to Prismic.io and Contentful. Contentful is definitely the larger organization, but Prismic was less expensive and offered scheduled deploys and previewing, which our marketing team really wanted. Ultimately we chose Prismic. The rest of the talk will be focused on how we integrated Prismic into our site, but the same principles can be applied to any headless CMS.</span>
<h1><span style="font-weight: 400;">The Approach</span></h1>
<span style="font-weight: 400;">During this time we were actually rewriting our site again after switching to Spree. In our zeal to keep our new Spree site functioning like our legacy site, we customized Spree too heavily and ended up running on our own fork of Spree, effectively eliminating the benefit of an open source community. Our team decided the best course of action was to start fresh with a Solidus-based site and pull over only features and code that were absolutely necessary.</span>

<span style="font-weight: 400;">This was also a great time to implement a new Prismic marketing change, and so we began talking with the marketing team about exactly what would be useful to them. We came up with a few components they wanted to use around the site like sliders, hero banners, mini banners, carousels, multi-item carousels, and headings. Knowing what kinds of content they wanted to place around the site, we simply needed to constrain those elements in a way that was both predictable for the site and simple to create and update for the Marketers.</span>

<span style="font-weight: 400;">To accomplish that, we created Content Schemas in Prismic. These house all of the data about your component, things like name, product ID, display type, etc. I’ll go over an example of one of these components here. </span>

<span style="font-weight: 400;">This is the Content Schema for a multi item carousel. First we see that the Component is a Carousel with the tag  “Multi item,” which helps distinguish between two or more types of the same component. Then each item in the Carousel is displayed with data about it: product name, description, custom link, button text, product SKU, and a custom image. Marketers can quickly update information that is specific to this Carousel without changing any data in our storefront. To identify where to place these components, we use Prismic’s tagging system with defined tags to be pulled into specific locations in our store. For example, anything that needs to appear on a specific taxon page is tagged with the taxon slug like “art-and-home/framed”.</span>

<span style="font-weight: 400;">Once the schema is set up and a component created, the site needs to pull in that data from Prismic and display it. We do this by making a call to their API and fetching documents related to a tag based on the page we are currently on. For taxon pages, we pull documents tagged with the current taxon’s slug. Now we have a JSON object with documents that should be rendered. Since this is just JSON and not HTML, we create partials to translate the Prismic data into something more meaningful.</span>

<span style="font-weight: 400;">This is our partial for carousels on our site. It handles both single-item and multi-item carousels and renders differently based on the type returned from Prismic. Here is where we are ensuring that the way things are rendered is consistent and within our predefined guidelines. However, in order to encourage a pattern of controlled content entry for flexible content presentation, Prismic does not allow for raw HTML. In our case we are going to handle all the HTML rendering based on the fields entered in Prismic.</span>

<span style="font-weight: 400;">Custom names, descriptions, and images are rendered from what was input in Prismic, but we also give the option to simply put in a SKU and handle the rendering from within the store. At Deseret Book we rely more heavily on Variant SKUs than anything else, but you could just as easily use the Product or Variant IDs to specify an individual product you wish to market. This makes life easier because custom data is not required, and it allows the site to consistently render the proper link and image.</span>

<span style="font-weight: 400;">Now that you have an idea of what an individual component looks like, let’s take a look at our big project of allowing Marketers to update the entire homepage from Prismic. Each section of the homepage is a different document housing many components. We have our top section, which has a hero banner and mini banners; our left section with carousels, single item spotlights, and headers; and our right section with our curated Top Ten list and some single-image components.</span>

<span style="font-weight: 400;">The home page looks exactly the same as it did before we implemented Prismic. Because everything is just a partial in Rails, we were able to match our current site without problem, and we also maintain consistency throughout the site since every Prismic component will render the same way on every page. Hero banners on taxon pages look the same as the Hero banner on the home page.</span>
<h1><span style="font-weight: 400;">Results</span></h1>
<span style="font-weight: 400;">After converting our entire site to Prismic, we actually saw faster load times because Prismic compresses files for us that previously weren’t being compressed properly. Ad blockers no longer stopped portions of our site from rendering because the server was the one making the request for marking data rather than the client. And we can now cache those pages to make rendering even faster, although the one caveat to that is each page still needs to make a call to Prismic to ensure it has the latest version of the site. If their API is down or stalls, it can add loading time. We wrapped our calls to Prismic in a rescue and cached the old Prismic ref. If there is a problem with the call to Prismic, we just load the currently cached version of each page.</span>

<span style="font-weight: 400;">We also integrated Prismic into our mobile apps, and it is now the central location for marketing across all of our sites and allows marketers to quickly make updates and changes to our web and mobile apps. This saved a lot of money in possibly getting another solution that focused on just mobile in-app marketing.</span>
<h1><span style="font-weight: 400;">Demo/Gem</span></h1>
<span style="font-weight: 400;">To finish up I wanted to do a really quick demo where we will actually edit our site, do a preview of that edit, and publish it so you can all see how that flow looks. </span>

<span style="font-weight: 400;">Here in Prismic I’m editing the home page section to change an image. I can save it up here, then we can preview it on the site, live. Once I’m happy with it, we can either schedule a time for it to be published or just publish it right now. In addition to scheduling a time, Prismic allows you to create releases, which lets marketers work on an entire series of changes and lump them into a single event that will all be published together. Last year they used it with great success for the 12 Days of Christmas sales we do. As you change and make edits to documents in Prismic, it will keep track of the differences. You can even fork different items to make changes just like Git. </span>

<span style="font-weight: 400;">I’ll publish it now. We’ll go back to DeseretBook.com and you can see my change is now live.</span>

<span style="font-weight: 400;">To help you get started with all of this, I am announcing two gems, one for Prismic and one for Contentful that will plug into Solidus. Included in those gems are starter templates for basic marketing components. We have loved everything about what Prismic has given us, and I really hope you’ll consider using an API-based CMS to enhance your store too. Thank you.</span>
